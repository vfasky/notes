define("note/app",["jquery","note/route","catke"],function(t,e,n){"use strict";var i=n.popTips,r=n.Loading,o=n.classExt,a=new r({tip:"加载中 ... "}),u=function(e,n){this._route={},this._view=null,this.addEvent("viewBeforeShow"),this.addEvent("viewAfterShow"),this.$el=e,this.config=t.extend({viewClass:"app-view",Template:null},n||{}),this.loading=a,this.popTips=i};return u.prototype=o.extendProto(o.ClassEvent.prototype),u.prototype.callView=function(e,n,i){var r,o=this;this.callEvent("viewBeforeShow",e),i=i||function(){};var a=function(t){i(),o.callEvent("viewAfterShow",t)};if(null!==o._view){if(o._view.name===e)return o._view.instance.run(n),void a(o._view.instance);var u=o._view.instance;u.destroy()}o.loading.show();var s=function(i){o.loading.hide(),r=t('<div class="'+o.config.viewClass+'"></div>');var u=new i(r,o);u.run(n),o._view={name:e,instance:u},u.$el.appendTo(o.$el),a(o._view.instance)};if("string"==typeof e){var p=window.requirejs||window.require;p([e],function(t){s(t)})}else s(e)},u.prototype.route=function(t,e,n){return void 0===n&&(n=e,e={}),this._route[t]=[e,n],this},u.prototype.url=function(e){e=t.trim(e);for(var n in this._route){var i=this._route[n];if(e===i[1])return n}},u.prototype.run=function(){var t=this,n=new e;for(var i in t._route)!function(e){var i=t._route[e];n.map(e,i[0],function(e){t.callView(i[1],e||{})})}(i);n.init()},u}),define("note/book",["note/view"],function(t){"use strict";return t.extend({initialize:function(t,e){this.superclass.initialize.call(this,t,e)},run:function(t){this.superclass.run.call(this,t)}})}),define("note/main",["note/app","jquery"],function(t){"use strict";return function(e){var n=new t(e,{Template:null});n.route("/","note/book").run()}}),define("note/route",["jquery"],function(t){"use strict";var e={addEventListener:function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n},removeEventListener:function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null},proxy:function(t,e){var n=function(){return t.apply(e||this,arguments)};return n}},n=function(){this._routes=[]};return n.prototype.init=function(){var t=this;e.addEventListener(window,"hashchange",e.proxy(t.listener,this)),this.listener()},n.prototype.listener=function(){var e,n=location.hash.slice(1).split("?"),i=n[0];n[1]&&(e=this.getUrlParams(n[1]));var r,o=this.getRoute(i),a={};if(!o)return void location.replace("#/");r=this.getValues(i,o);for(var u=0;u<o.params.length;u++)a[o.params[u]]=r[u];e=t.extend({},a,e),o.handle(e)},n.prototype.getUrlParams=function(t){var e={};if(!t)return e;for(var n,i=t.split("&"),r=0;r<i.length;r++)n=i[r].split("="),e[n[0]]=n[1];return e},n.prototype.map=function(t,e,n){var i,r,o,a=[];if(r=t.replace(/\//g,"\\/"),"function"==typeof e&&(n=e,e=null),e)for(var u in e)i=new RegExp("\\{"+u+"\\}","g"),r=r.replace(i,"("+e[u].replace(/\^/,"").replace(/\$/,"")+")"),a.push(u);for(i=new RegExp("{([^}]+)}","g");null!==(o=i.exec(r));)a.push(o[1]),i.lastIndex;return r="^"+r.replace(/{[^}]+}/gi,"(.+)")+"$",this._routes.push({routeUrl:t,pattern:r,params:a,handle:n||function(){}}),this},n.prototype.getValues=function(t,e){var e,n=[];if(0===t.length)return n;if(e=e||this.getRoute(t),null!==e){var i=t.match(e.pattern);if(0!==i.length)for(var r=1;r<i.length;r++)n.push(i[r])}return n},n.prototype.getRoute=function(t){for(var e=0;e<this._routes.length;e++)if(new RegExp(this._routes[e].pattern).test(t))return this._routes[e];return null},n}),define("site/template",["ant"],function(t){"use strict";var e={};return e.String=String,e.Number=Number,t.extend({defaults:{filters:e}},{load:function(t){console.log(t)}})}),define("note/view",["jquery","catke"],function(t,e){"use strict";var n=e.http,i=e.classExt,r=function(t,e){this.$el=t,this.app=e,e.config.Template&&(this.Template=e.config.Template),this.http=n};return r.prototype.when=function(){return t.when.apply(this,arguments)},r.prototype.run=function(t){this.context=t},r.prototype.destroy=function(){this.$el.remove()},r.extend=function(t){return i.extend(r,t)},r}),define("note",["note/app","note/book","note/main","note/route","note/template","note/view"],function(t,e,n,i,r,o){return{App:t,Book:e,main:n,Route:i,Template:r,View:o}});