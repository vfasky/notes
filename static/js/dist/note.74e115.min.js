define("note/app",["jquery","note/router","catke/popTips","catke/loading","catke/classExt"],function(t,e,n,i,r){"use strict";var o=new i({tip:"加载中 ... "}),a=function(e,i){this._route={},this._view=null,this.addEvent("viewBeforeShow"),this.addEvent("viewAfterShow"),this.$el=e,this.config=t.extend({viewClass:"app-view",Template:null},i||{}),this.loading=o,this.popTips=n};return a.prototype=r.extendProto(r.ClassEvent.prototype),a.prototype.callView=function(e,n,i){var r,o=this;this.callEvent("viewBeforeShow",e),i=i||function(){};var a=function(t){i(),o.callEvent("viewAfterShow",t)};if(null!==o._view){if(o._view.name===e)return o._view.instance.run(n),void a(o._view.instance);var s=o._view.instance;s.destroy()}o.loading.show();var u=function(i){o.loading.hide(),r=t('<div class="'+o.config.viewClass+'"></div>');var s=new i(r,o);s.run(n),o._view={name:e,instance:s},s.$el.appendTo(o.$el),a(o._view.instance)};if("string"==typeof e){var p=window.requirejs||window.require;p([e],function(t){u(t)})}else u(e)},a.prototype.route=function(t,e,n){return void 0===n&&(n=e,e={}),this._route[t]=[e,n],this},a.prototype.url=function(e){e=t.trim(e);for(var n in this._route){var i=this._route[n];if(e===i[1])return n}},a.prototype.run=function(){var t=this,n=new e;for(var i in t._route)!function(e){var i=t._route[e];n.map(e,i[0],function(e){t.callView(i[1],e||{})})}(i);n.init()},a}),define("note/router",["jquery"],function(t){"use strict";var e={addEventListener:function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n},removeEventListener:function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null},proxy:function(t,e){var n=function(){return t.apply(e||this,arguments)};return n}},n=function(){this._routes=[]};return n.prototype.init=function(){var t=this;e.addEventListener(window,"hashchange",e.proxy(t.listener,this)),this.listener()},n.prototype.listener=function(){var e,n=location.hash.slice(1).split("?"),i=n[0];n[1]&&(e=this.getUrlParams(n[1]));var r,o=this.getRoute(i),a={};if(!o)return void location.replace("#/");r=this.getValues(i,o);for(var s=0;s<o.params.length;s++)a[o.params[s]]=r[s];e=t.extend({},a,e),o.handle(e)},n.prototype.getUrlParams=function(t){var e={};if(!t)return e;for(var n,i=t.split("&"),r=0;r<i.length;r++)n=i[r].split("="),e[n[0]]=n[1];return e},n.prototype.map=function(t,e,n){var i,r,o,a=[];if(r=t.replace(/\//g,"\\/"),"function"==typeof e&&(n=e,e=null),e)for(var s in e)i=new RegExp("\\{"+s+"\\}","g"),r=r.replace(i,"("+e[s].replace(/\^/,"").replace(/\$/,"")+")"),a.push(s);for(i=new RegExp("{([^}]+)}","g");null!==(o=i.exec(r));)a.push(o[1]),i.lastIndex;return r="^"+r.replace(/{[^}]+}/gi,"(.+)")+"$",this._routes.push({routeUrl:t,pattern:r,params:a,handle:n||function(){}}),this},n.prototype.getValues=function(t,e){var e,n=[];if(0===t.length)return n;if(e=e||this.getRoute(t),null!==e){var i=t.match(e.pattern);if(0!==i.length)for(var r=1;r<i.length;r++)n.push(i[r])}return n},n.prototype.getRoute=function(t){for(var e=0;e<this._routes.length;e++)if(new RegExp(this._routes[e].pattern).test(t))return this._routes[e];return null},n}),define("note/view",["jquery","catke/http","catke/classExt"],function(t,e,n){"use strict";var i=function(t,n){this.$el=t,this.app=n,n.config.Template&&(this.Template=n.config.Template),this.http=e};return i.prototype.when=function(){return t.when.apply(this,arguments)},i.prototype.run=function(t){this.context=t},i.prototype.destroy=function(){this.$el.remove()},i.extend=function(e){e=t.extend({initialize:function(){}},e||{});var r=e.initialize,o=function(t,e){this.superclass=i.prototype,this.superclass.initialize=i,r.call(this,t,e)};o.prototype=n.extendProto(i.prototype),delete e.initialize;for(var a in e)o.prototype[a]=e[a];return o},i}),define("note",["note/app","note/route","note/view"],function(t,e,n){return{App:t,Route:e,View:n}});