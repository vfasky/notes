define("note/api",["jquery","catke"],function(t,e){"use strict";var n=e.http,i="/api/v1/",r={getBooks:function(t,e){return n.get(i+"book",{page:t||1,pageSize:e||10})}};return r}),define("note/app",["jquery","note/route","catke"],function(t,e,n){"use strict";var i=n.popTips,r=n.Loading,o=n.classExt,s=new r({tip:"加载中 ... "}),u=function(e,n){this._route={},this._view=null,this.addEvent("viewBeforeShow"),this.addEvent("viewAfterShow"),this.$el=e,this.config=t.extend({viewClass:"app-view",Template:null},n||{}),this.loading=s,this.popTips=i};return u.prototype=o.extendProto(o.ClassEvent.prototype),u.prototype.callView=function(e,n,i){var r,o=this;this.callEvent("viewBeforeShow",e),i=i||function(){};var s=function(t){i(),o.callEvent("viewAfterShow",t)};if(null!==o._view){if(o._view.name===e)return o._view.instance.run(n),void s(o._view.instance);var u=o._view.instance;u.destroy()}o.loading.show();var a=function(i){o.loading.hide(),r=t('<div class="'+o.config.viewClass+'"></div>');var u=new i(r,o);u.run(n),o._view={name:e,instance:u},u.$el.appendTo(o.$el),s(o._view.instance)};if("string"==typeof e){var p=window.requirejs||window.require;p([e],function(t){a(t)})}else a(e)},u.prototype.route=function(t,e,n){return void 0===n&&(n=e,e={}),this._route[t]=[e,n],this},u.prototype.url=function(e){e=t.trim(e);for(var n in this._route){var i=this._route[n];if(e===i[1])return n}},u.prototype.run=function(){var t=this,n=new e,i=function(e){var i=t._route[e];n.map(e,i[0],function(e){t.callView(i[1],e||{})})};for(var r in t._route)i(r);n.init()},u}),define("note/book",["note/view","note/api"],function(t,e){"use strict";return t.extend({initialize:function(t,e){this.superclass.initialize.call(this,t,e)},run:function(t){this.superclass.run.call(this,t),this.when(this.initAnt("note/book.html",{data:{books:[]}}),e.getBooks()).done(function(t,e){t.set({books:e.books})})}})}),define("note/main",["note/app"],function(t){"use strict";return function(e){var n=new t(e);n.route("/","note/book").run()}}),define("note/route",["jquery"],function(t){"use strict";var e=function(){this._routes=[]};return e.prototype.init=function(){var e=this;t(window).on("hashchange",function(){e.listener.apply(e,arguments)}),this.listener()},e.prototype.listener=function(){var e,n=location.hash.slice(1).split("?"),i=n[0];n[1]&&(e=this.getUrlParams(n[1]));var r,o=this.getRoute(i),s={};if(!o)return void location.replace("#/");r=this.getValues(i,o);for(var u=0;u<o.params.length;u++)s[o.params[u]]=r[u];e=t.extend({},s,e),o.handle(e)},e.prototype.getUrlParams=function(t){var e={};if(!t)return e;for(var n,i=t.split("&"),r=0;r<i.length;r++)n=i[r].split("="),e[n[0]]=n[1];return e},e.prototype.map=function(t,e,n){var i,r,o,s=[];if(r=t.replace(/\//g,"\\/"),"function"==typeof e&&(n=e,e=null),e)for(var u in e)i=new RegExp("\\{"+u+"\\}","g"),r=r.replace(i,"("+e[u].replace(/\^/,"").replace(/\$/,"")+")"),s.push(u);for(i=new RegExp("{([^}]+)}","g");null!==(o=i.exec(r));)s.push(o[1]),i.lastIndex;return r="^"+r.replace(/{[^}]+}/gi,"(.+)")+"$",this._routes.push({routeUrl:t,pattern:r,params:s,handle:n||function(){}}),this},e.prototype.getValues=function(t,e){var e,n=[];if(0===t.length)return n;if(e=e||this.getRoute(t),null!==e){var i=t.match(e.pattern);if(0!==i.length)for(var r=1;r<i.length;r++)n.push(i[r])}return n},e.prototype.getRoute=function(t){for(var e=0;e<this._routes.length;e++)if(new RegExp(this._routes[e].pattern).test(t))return this._routes[e];return null},e}),define("note/template",["ant","jquery"],function(t,e){"use strict";var n;return n=function(i,r){return r=e.extend({filters:n.filters},r||{}),new t(i,r)},n.filters={String:String,Number:Number},n.load=function(t){var n=e.Deferred(),i=t.split("/");return 2!==i.length||-1===i[1].indexOf(".html")?n.reject("tpl uri error : "+t):require(["tpl/"+i[0]],function(t){n.resolve(t[i[1]])}),n.promise()},n}),define("note/view",["jquery","catke","note/template"],function(t,e,n){"use strict";var i=e.http,r=e.classExt,o=function(t,e){this.$el=t,this.app=e,this.template=n,this.http=i};return o.prototype.when=function(){return t.when.apply(this,arguments)},o.prototype.run=function(t){this.context=t},o.prototype.destroy=function(){this.$el.remove()},o.prototype.initAnt=function(e,n){var i=t.Deferred(),r=this;return this.ant?i.resolve(this.ant):this.template.load(e).done(function(t){r.$el.html(t),r.ant=r.template(r.$el,n||{}),i.resolve(r.ant)}),i.promise()},o.extend=function(t){return r.extend(o,t)},o}),define("note",["note/api","note/app","note/book","note/main","note/route","note/template","note/view"],function(t,e,n,i,r,o,s){return{Api:t,App:e,Book:n,main:i,Route:r,Template:o,View:s}});